<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>What is wrong with TOML? - HitchDev</title>
    <meta name="generator" content="Hugo 0.31.1" />

    
    <meta name="description" content="The code that specifies | builds | runs | tests | documents your code.">
    
    <link rel="canonical" href="https://hitchdev.com/strictyaml/why-not/toml/">
    
    <meta name="author" content="Colm O&#39;Connor">
    

    <meta property="og:url" content="https://hitchdev.com/strictyaml/why-not/toml/">
    <meta property="og:title" content="HitchDev">
    <meta property="og:image" content="https://hitchdev.com/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="HitchDev">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://hitchdev.com/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://hitchdev.com/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://hitchdev.com/fonts/icon.eot');
        src: url('https://hitchdev.com/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://hitchdev.com/fonts/icon.woff')
               format('woff'),
             url('https://hitchdev.com/fonts/icon.ttf')
               format('truetype'),
             url('https://hitchdev.com/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/application.css">
    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://hitchdev.com/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-green palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
        
        <a style="display:inline;" href="https://hitchdev.com/">hitchdev</a>
        
          
            
            / <a style="display:inline;" href='https://hitchdev.com/strictyaml'>strictyaml</a>
            
            
        
          
            
            / <a style="display:inline;" href='https://hitchdev.com/strictyaml/why-not'>why-not</a>
            
            
        
          
            
            / <a style="display:inline;" href='https://hitchdev.com/strictyaml/why-not/toml'>toml</a>
            
            
        
          
            
        
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/hitchdev" title="@hitchdev on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>

</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://hitchdev.com/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://hitchdev.com/images/logo.png">
        </div>
      
      <div class="name">
        <strong>HitchDev </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="CommandLib" href="https://hitchdev.com/commandlib/">
	
	CommandLib
</a>



  
</li>



<li>
  
    



<a  title="HitchRunPy" href="https://hitchdev.com/hitchrunpy/">
	
	HitchRunPy
</a>



  
</li>



<li>
  
    



<a  title="HitchStory" href="https://hitchdev.com/hitchstory/">
	
	HitchStory
</a>



  
</li>



<li>
  
    



<a  title="SeleniumDirector" href="https://hitchdev.com/seleniumdirector/">
	
	SeleniumDirector
</a>



  
</li>



<li>
  
    



<a  title="StrictYAML" href="https://hitchdev.com/strictyaml/">
	
	StrictYAML
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/hitchdev" target="_blank" title="@hitchdev on GitHub">
              @hitchdev on GitHub
            </a>
          </li>
          

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>What is wrong with TOML? </h1>

			

<p><a href="https://github.com/toml-lang/toml">TOML</a> is an improved version of <a href="../ini">INI</a> -
analogous to how <a href="https://github.com/crdoconnor/strictyaml">StrictYAML</a> is a
improved version of YAML.</p>

<p>While StrictYAML <a href="../../features-removed">removed features</a> from YAML,
TOML added features to INI.</p>

<p>TOML does work ok if you use it infrequently, for relatively small and non-complex
configuration files, but the warts appear relatively quickly as you scale up its
use.</p>

<p>Martin Vejn√°r, the author of PyTOML
<a href="https://github.com/avakar/pytoml/issues/15#issuecomment-217739462">argued exactly this</a>
when asked whether he would like to see his library used as a dependency for pip as
part of <a href="https://www.python.org/dev/peps/pep-0518/">PEP-518</a>:</p>

<blockquote>
<p>TOML is a bad file format. <strong>It looks good at first glance</strong>, and for really really
trivial things it is probably good. But once I started using it and the
configuration schema became more complex, I found the syntax ugly and hard to read.</p>
</blockquote>

<p>Ultimately, despite this PyPA still used TOML for PEP-518 with a different parser.
I don&rsquo;t believe this to be an awful decision since pyproject.toml is fairly trivial
in its complexity and there&rsquo;s only one per project.</p>

<p>StrictYAML, by contrast, was designed to be a language to write
<a href="../../hitchstory">readable tests with</a> - a use case for which there is likely
to be a lot more nested hierarchies and a lot more than just one file.</p>

<p>So what specifically is wrong with TOML when you scale it up?</p>

<h2 id="1-human-readability-toml-s-hierarchy-is-difficult-to-infer-from-syntax-alone">1. Human readability: TOML&rsquo;s hierarchy is difficult to infer from syntax alone</h2>

<p>Mapping hierarchy in TOML is determined by dots. This is simple enough for
parsers to read and understand but this alone makes it difficult to perceive
the relationships between data.</p>

<p>This has been recognized by many TOML users who have adopted a method that
will be quite familiar to a lot of programmers:</p>

<p><a href="https://github.com/gazreese/gazreese.com/blob/c4c3fa7d576a4c316f11f0f7a652ca11ab23586d/Hugo/config.toml"><img src="../toml-indentation-1.png" alt="Non-meaningful indentation" /></a></p>

<p>Indentation that is meaningful to humans but not parsers (
<a href="https://github.com/leereilly/csi/blob/567e5b55f766847c9dcc7de482c0fd241fa7377a/lib/data/master.toml">Other</a>
<a href="https://github.com/CzarSimon/simonlindgren.info/blob/a391a6345b16f2d8093f6d4c5f422399b4b901eb/simon-cv/config.toml">examples</a>).</p>

<p>This parallels the way indentation is added in <em>lots</em> of programming languages with syntactic markers
- e.g.  JSON, Javascript or Java are all commonly rendered with non-parsed indentation to make it
easier for humans to understand.</p>

<p>But not python.</p>

<p>Python, has long been a stand out exception in how it was designed -
syntactic markers are <em>not</em> necessary to infer program structure because indentation <em>is</em> the marker
that determines program structure.</p>

<p>This argument over the merits of meaningful indentation in python has been going on for decades, but the various points are argued pretty well in this <a href="https://softwareengineering.stackexchange.com/questions/313034/why-should-a-language-prefer-indentation-over-explicit-markers-for-blocks">stack exchange question asking why python did it</a>. In summary:</p>

<ol>
<li><p>Python inherited the significant indentation from the (now obsolete) predecessor language ABC. ABC is one of the very few programming languages which have used usability testing to direct the design. So while discussions about syntax usually comes down to subjective opinions and personal preferences, the choice of significant indentation actually have a sounder foundation.</p></li>

<li><p>Guido van Rossum came across subtle bugs where the indentation disagreed with the syntactic grouping. Meaningful indentation fixed this class of bug. Since there are no begin/end brackets there cannot be a disagreement between grouping perceived by the parser and the human reader.</p></li>

<li><p>Having symbols delimiting blocks and indentation violates the DRY principle.</p></li>

<li><p>It does away with the typical religious C debate of &ldquo;where to put the curly braces&rdquo;.</p></li>
</ol>

<h2 id="2-overcomplication-like-yaml-it-has-too-many-features">2. Overcomplication: Like YAML it has too many features</h2>

<p>Somewhat ironically, TOML&rsquo;s creator quite rightly criticizes YAML for not aiming for simplicity
and then unfortunately falls into the same trap itself - albeit not quite as deeply.</p>

<p>One way it does this is by trying to include date and time parsing which imports
<em>all</em> of the inherent complications associated with dates and times. Dates and times,
as many more experienced programmers are probably aware is an unexpectedly deep rabbit hole
of <a href="https://infiniteundo.com/post/25326999628/falsehoods-programmers-believe-about-time">complications and quirky, unexpected, bug inducing edge cases</a>.</p>

<p>The best way to deal with complications like these is to decouple, isolate the complexity and <em>delegate</em> it to a
<a href="https://en.wikipedia.org/wiki/Unix_philosophy">specialist tool that is good at handling that specific problem</a>.</p>

<p>StrictYAML takes JSON&rsquo;s (arguably successful) KISS approach - that is, for complex data types parsed from and
serialized to strings, parsing and serialization of strings should be delegated to another tool.</p>

<p>StrictYAML the library (as opposed to the format) has a validator that uses
<a href="https://dateutil.readthedocs.io/en/stable/">python&rsquo;s most popular date/time parsing library</a> although
developers are encouraged to carefully consider their own need create their own
date parser/serializer using different tools if it doesn&rsquo;t fit their needs.</p>

<h2 id="3-human-readability-toml-has-noisy-syntax">3. Human readability: TOML has noisy syntax</h2>

<p>Like most other markup languages TOML has <a href="../../why/syntax-typing-bad">syntax typing</a> -
the <em>writer</em> of the markup decides if, for example, something should be parsed as a number
or a string:</p>
<div class="highlight"><pre class="chroma"><code class="language-toml" data-lang="toml"><span class="nx">flt2</span> <span class="p">=</span> <span class="mf">3.1415</span>
<span class="nx">string</span> <span class="p">=</span> <span class="s2">&#34;hello&#34;</span></code></pre></div>
<p>StrictYAML does not require quotes around any value to infer a data type because the
schema is assumed to be the single source of truth for type information:</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml">flt<span class="m">2</span><span class="p">:</span><span class="w"> </span><span class="m">3.1415</span><span class="w">
</span><span class="w"></span>string<span class="p">:</span><span class="w"> </span>hello</code></pre></div>
<p>In the above example it just removes two characters, but in larger documents with more
complex data, pushing type parsing decision to the schema (or assuming strings)
emoves an enormous amount of syntactic noise.</p>

<p>The lack of syntax typing combined with the use of indentation instead of square brackets
to denote hierarchies makes equivalent StrictYAML documents 10-20% shorter, cleaner
and ultimately more readable.</p>

<h2 id="advantages-of-toml-still-has-over-strictyaml">Advantages of TOML still has over StrictYAML</h2>

<p>There are currently still a few:</p>

<ul>
<li><p>StrictYAML does not currently have an &ldquo;official spec&rdquo;. The spec is currently just &ldquo;YAML 2.0 with <a href="../../features-removed">features removed</a>&rdquo;. This has some advantages (e.g. YAML syntax highlighting in editors works just fine) but also some disadvantages (some documents will render differently).</p></li>

<li><p>StrictYAML does not yet have parsers in languages other than python. If you&rsquo;d like to write one for your language (if you don&rsquo;t also do validation it actually wouldn&rsquo;t be very complicated), contact me, I&rsquo;d love to help you in any way I can - including doing a test suite and documentation.</p></li>

<li><p>Popularity.</p></li>
</ul>


			<aside class="copyright" role="note">
				
				&copy; 2018 Copyright (C) 2018 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://hitchdev.com/hitchstory/approach/test-or-story/" title="What is the difference betweeen a test and a story?">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              What is the difference betweeen a test and a story?
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://hitchdev.com/strictyaml/why/duplicate-keys-disallowed/" title="What is wrong with duplicate keys?">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              What is wrong with duplicate keys?
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="https://hitchdev.com/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

