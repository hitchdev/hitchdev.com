<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Why avoid using environment variables as configuration? - HitchDev</title>
    <meta name="generator" content="Hugo 0.50" />

    
    <meta name="description" content="The code that specifies | builds | runs | tests | documents your code.">
    
    <link rel="canonical" href="https://hitchdev.com/strictyaml/why-not/environment-variables-as-config/">
    
    <meta name="author" content="Colm O&#39;Connor">
    

    <meta property="og:url" content="https://hitchdev.com/strictyaml/why-not/environment-variables-as-config/">
    <meta property="og:title" content="HitchDev">
    <meta property="og:image" content="https://hitchdev.com/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="HitchDev">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://hitchdev.com/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="https://hitchdev.com/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://hitchdev.com/fonts/icon.eot');
        src: url('https://hitchdev.com/fonts/icon.eot')
               format('embedded-opentype'),
             url('https://hitchdev.com/fonts/icon.woff')
               format('woff'),
             url('https://hitchdev.com/fonts/icon.ttf')
               format('truetype'),
             url('https://hitchdev.com/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/application.css">
    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://hitchdev.com/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="https://hitchdev.com/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-green palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
        
        <a style="display:inline;" href="https://hitchdev.com/">hitchdev</a>
        
          
            
            / <a style="display:inline;" href='https://hitchdev.com/strictyaml'>strictyaml</a>
            
            
        
          
            
            / <a style="display:inline;" href='https://hitchdev.com/strictyaml/why-not'>why-not</a>
            
            
        
          
            
            / <a style="display:inline;" href='https://hitchdev.com/strictyaml/why-not/environment-variables-as-config'>environment-variables-as-config</a>
            
            
        
          
            
        
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/hitchdev" title="@hitchdev on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>

</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://hitchdev.com/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://hitchdev.com/images/logo.png">
        </div>
      
      <div class="name">
        <strong>HitchDev </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="CommandLib" href="https://hitchdev.com/commandlib/">
	
	CommandLib
</a>



  
</li>



<li>
  
    



<a  title="Faketime" href="https://hitchdev.com/faketime/">
	
	Faketime
</a>



  
</li>



<li>
  
    



<a  title="HitchRunPy" href="https://hitchdev.com/hitchrunpy/">
	
	HitchRunPy
</a>



  
</li>



<li>
  
    



<a  title="HitchStory" href="https://hitchdev.com/hitchstory/">
	
	HitchStory
</a>



  
</li>



<li>
  
    



<a  title="SeleniumDirector" href="https://hitchdev.com/seleniumdirector/">
	
	SeleniumDirector
</a>



  
</li>



<li>
  
    



<a  title="StrictYAML" href="https://hitchdev.com/strictyaml/">
	
	StrictYAML
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          

          
          <li>
            <a href="https://github.com/hitchdev" target="_blank" title="@hitchdev on GitHub">
              @hitchdev on GitHub
            </a>
          </li>
          

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Why avoid using environment variables as configuration? </h1>

			

<p>The use of &ldquo;environment variables as configuration&rdquo; is recommended by
&ldquo;<a href="https://12factor.net/config">12 factor</a>&rdquo;. While this is a common
practice and often leads to few or no problems, calling it a best
practice is a bit much.</p>

<p>The reason cited by the 12 factor website for using them is:</p>

<blockquote>
<p>The twelve-factor app stores config in environment variables (often shortened to env vars or env). Env vars are easy to change between deploys without changing any code; unlike config files, there is little chance of them being checked into the code repo accidentally; and unlike custom config files, or other config mechanisms such as Java System Properties, they are a language- and OS-agnostic standard.</p>
</blockquote>

<p>Two of these are fine reasons. It is true that these are both good reasons:</p>

<ul>
<li>Easy to change between deploys.</li>
<li>Language and OS agnostic.</li>
</ul>

<p>However, neither of these things requires that config be stored in environment variables.
It&rsquo;s easy enough to create language and OS agnostic configuration files
(INI, YAML, etc.) and it&rsquo;s usually straightforward to make files easy to change
between deployments too - e.g. if a deployment is containerized, by mounting the file.</p>

<p>It is less true that environment variables are inherently &ldquo;easier&rdquo; to change between
deployments - writing a file is not intrinsically difficult unless it is <em>made</em>
difficult (e.g. a file is baked in to a container image rather than being mounted), it
isn&rsquo;t hard to change.</p>

<p>Moreover, there are several disadvantages to using environment variables
that tend to exhibit themselves nastily when the size of the configuration grows beyond
a certain point.</p>

<h2 id="environment-variables-are-global-state">Environment variables are global state</h2>

<p>Environment variables are a form of global state. Every variable
is associated only with the environment. The variables will be shared with many
other variables which have a multitude of different uses:</p>

<ul>
<li><p>The chances of variable cross contamination is high - accidentally naming one variable the same as another which is unknowingly used for a different purpose (e.g. PATH) is elevated, and this can have both weird, hard to debug and terrible effects.</p></li>

<li><p>If you need to inspect environment variables e.g. to find one that you thought was there and it actually missing, tracking it down is a pain.</p></li>
</ul>

<p>Global state in and of itself isn&rsquo;t a &ldquo;bad thing&rdquo; but <em>too much</em> global
state is a very bad thing. A small amount of configuration (e.g. less than
10 variables) can often be placed in to environment variables with very
little harm, but as soon as the amount grows the danger of the global
state grows.</p>

<h2 id="environment-variable-values-cannot-handle-structures-more-complex-than-a-string">Environment variable values cannot handle structures more complex than a string</h2>

<p>Environment variables are a set of key-value pairs where the key is almost always an
uppercase string and the value is always a string.</p>

<p>While this is more than sufficient for many purposes, there are many kinds of situations
where the configuration data that needs to be stored requires something a bit more
complicated than just a string.</p>

<p>Where developers run in to this limitation they have a tendency to create an ugly substructure with
cryptic codes within the string.</p>

<p>The way that LS_COLORS is used is a good example:</p>

<pre><code>rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:
</code></pre>

<p>Clear as mud, right?</p>

<p>(This isn&rsquo;t actually an example of 12 factor being followed assiduously, but I have seen many examples
just like it where it was).</p>

<p>In <a href="https://hitchdev.com/strictyaml">StrictYAML</a> the following could be represented as:</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="c"># Special</span><span class="w">
</span><span class="w">
</span><span class="w"></span>di<span class="p">:</span><span class="w"> </span><span class="m">01</span>;<span class="m">34</span><span class="w">      </span><span class="c"># directory is blue</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># Extensions</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="cp">*.tz:</span><span class="w"> </span><span class="m">01</span>;<span class="m">31</span><span class="w">    </span><span class="c"># red</span><span class="w">
</span><span class="w"></span><span class="cp">*.flv:</span><span class="w"> </span><span class="m">01</span>;<span class="m">35</span><span class="w">   </span><span class="c"># purple</span></code></pre></div>
<p>While the codes are cryptic and probably should be changed (e.g. directory: blue), the cryptic nature
can at least be easily explained with comments.</p>

<h2 id="creating-naming-conventions-to-handle-the-inability-to-handle">Creating naming conventions to handle the inability to handle</h2>

<p>A common example:</p>

<blockquote>
<p>PERSONNEL_DATABASE_HOST, PERSONNEL_DATABASE_PORT, PERSONNEL_DATABASE_NAME, PERSONNEL_DATABASE_PASSWORD, FACTORY_DATABASE_HOST, FACTORY_DATABASE_PORT, FACTORY_DATABASE_NAME, FACTORY_DATABASE_PASSWORD,
HOTEL_BACKUP_DATABASE_HOST, HOTEL_BACKUP_DATABASE_USERNAME, HOTEL_BACKUP_DATABASE_PASSWORD, HOTEL_DATABASE_HOST, HOTEL_DATABASE_PORT, HOTEL_DATABASE_NAME, HOTEL_DATABASE_PASSWORD</p>
</blockquote>

<p>Did you spot the accidentally missed variable in the list above which caused the critical bug?</p>

<p><a href="https://hitchdev.com/strictyaml">StrictYAML</a> version:</p>
<div class="highlight"><pre class="chroma"><code class="language-yaml" data-lang="yaml">database<span class="p">:</span><span class="w">
</span><span class="w">  </span>personnel<span class="p">:</span><span class="w">
</span><span class="w">    </span>host<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>port<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>name<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>password<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">
</span><span class="w">  </span>factory<span class="p">:</span><span class="w">
</span><span class="w">    </span>host<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>port<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>name<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>password<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">
</span><span class="w">  </span>hotel<span class="w"> </span>backup<span class="p">:</span><span class="w">
</span><span class="w">    </span>host<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>name<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>password<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">
</span><span class="w">  </span>hotel<span class="p">:</span><span class="w">
</span><span class="w">    </span>host<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>name<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>port<span class="p">:</span><span class="w"> </span>xxx<span class="w">
</span><span class="w">    </span>password<span class="p">:</span><span class="w"> </span>xxx</code></pre></div>
<p>What about now?</p>


			<aside class="copyright" role="note">
				
				&copy; 2019 Copyright (C) 2019 &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://hitchdev.com/strictyaml/when-to-use-validators/" title="When should I use a validator and when should I not?">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              When should I use a validator and when should I not?
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://hitchdev.com/hitchstory/why/strictyaml/" title="Why does HitchStory use StrictYAML?">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Why does HitchStory use StrictYAML?
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="https://hitchdev.com/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

